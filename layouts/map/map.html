{{- partial "params.html" . -}}

<!DOCTYPE html>
<html lang='{{ .Site.LanguageCode }}'>
{{- partial "head.html" . -}}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

<body {{if .Params.Color }}data-color="{{ .Params.Color }}" {{ end }} class="show-all-images">
  <main>
    <div class="floating-nav">
      {{- partial "header.html" . -}}
      {{- partial "nav.html" . -}}
    </div>

    <div id="map"></div> <!-- Fullscreen map -->
  </main>
  {{- partial "resources/js.html" . -}}
  {{- partial "script.html" . -}}
</body>

<!-- Leaflet Scripts -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script type="module">
  // Define the correct aspect ratio for the image
  const imageWidth = 6000; // Replace with your image's actual width in pixels
  const imageHeight = 3265; // Replace with your image's actual height in pixels

  // Leaflet map initialization
  const map = L.map('map', {
    crs: L.CRS.Simple, // Simple coordinate system
    minZoom: -2,       // Allow zooming out
    maxZoom: 4,        // Increased zoom level
    attributionControl: false, // Disable the Leaflet logo
    zoomControl: false, // Disable default zoom control to reposition
  });

  // Define the image bounds and URL
  const imageBounds = [[0, 0], [imageHeight, imageWidth]]; // Using consistent variable names
  const imageUrl = '/svg/maps/world.png'; // Check server for correct path

  // Add image overlay
  L.imageOverlay(imageUrl, imageBounds).addTo(map);

  // Fit the map to the image bounds
  map.fitBounds(imageBounds);

  // Add zoom controls at the bottom right
  L.control.zoom({
    position: 'bottomright',
  }).addTo(map);

  // Restrict panning to the image bounds
  map.setMaxBounds(imageBounds);
</script>

<style>
  body {
  margin: 0;
  }

  main {
  margin-top: 0;
  margin-bottom: 0;
  position: relative;
  z-index: 1;
  margin-top: 0!important;
  }

  .floating-nav {
    z-index: 2;
    margin-top: 1rem;
  }

  #map {
    height: 100vh; /* Fullscreen map */
    width: 100vw;  /* Fullscreen width */
    top: 0;
    left: 0;
    position: absolute;
    z-index: 1;
    background: var(--map-background);
    margin-left: calc((90% - 100vw) / 2);  /* then remove the gap to the left of the container with this equation */
  }

  html[data-theme="dark"] {
    img {
     filter: hue-rotate(200deg) invert(95%) saturate(60%) sepia(0%) brightness(100%);
     }
  }
</style>

</html>